{
  "id": "fogclaw",
  "name": "FogClaw",
  "version": "0.3.0",
  "description": "PII detection & custom entity redaction plugin powered by DataFog",
  "configSchema": {
    "type": "object",
    "properties": {
      "enabled": {
        "type": "boolean",
        "default": true
      },
      "guardrail_mode": {
        "type": "string",
        "enum": ["redact", "block", "warn"],
        "default": "redact"
      },
      "redactStrategy": {
        "type": "string",
        "enum": ["token", "mask", "hash"],
        "default": "token"
      },
      "model": {
        "type": "string",
        "default": "onnx-community/gliner_large-v2.1"
      },
      "confidence_threshold": {
        "type": "number",
        "default": 0.5,
        "minimum": 0,
        "maximum": 1
      },
      "entityConfidenceThresholds": {
        "type": "object",
        "additionalProperties": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "default": {}
      },
      "custom_entities": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "default": []
      },
      "entityActions": {
        "type": "object",
        "additionalProperties": {
          "type": "string",
          "enum": ["redact", "block", "warn"]
        },
        "default": {}
      },
      "allowlist": {
        "type": "object",
        "properties": {
          "values": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "default": []
          },
          "patterns": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "default": []
          },
          "entities": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "default": {
          "values": [],
          "patterns": [],
          "entities": {}
        }
      },
      "auditEnabled": {
        "type": "boolean",
        "default": true
      },
      "maxPendingRequests": {
        "type": "integer",
        "default": 50,
        "minimum": 1
      }
    }
  },
  "uiHints": {
    "enabled": {
      "label": "Enable FogClaw",
      "help": "Enable or disable the plugin without uninstalling it."
    },
    "guardrail_mode": {
      "label": "Guardrail Mode",
      "help": "Default action for detections: redact, block, or warn."
    },
    "redactStrategy": {
      "label": "Redaction Strategy",
      "help": "How sensitive values are replaced in message context before the agent sees them."
    },
    "model": {
      "label": "GLiNER Model",
      "help": "Model used for zero-shot detection (defaults to onnx-community/gliner_large-v2.1).",
      "advanced": true
    },
    "confidence_threshold": {
      "label": "Confidence Threshold",
      "help": "Minimum GLiNER score (0-1) required before an entity is treated as a detection.",
      "advanced": true
    },
    "entityConfidenceThresholds": {
      "label": "Per-Entity Confidence Thresholds",
      "help": "Override confidence thresholds by entity label (for example: {\"PERSON\": 0.95, \"ORGANIZATION\": 0.7}).",
      "advanced": true
    },
    "custom_entities": {
      "label": "Custom Entity Labels",
      "help": "Extra labels to detect as sensitive entities (for example: `project code`, `competitor name`)."
    },
    "entityActions": {
      "label": "Entity Actions",
      "help": "Map specific entity labels to per-entity behavior (for example: {\"EMAIL\": \"block\", \"PHONE\": \"redact\"}).",
      "advanced": true
    },
    "allowlist": {
      "label": "Allowlist / Exemptions",
      "help": "Global and per-entity allowlist entries to exclude from enforcement. Supports exact values and regex patterns.",
      "advanced": true
    },
    "auditEnabled": {
      "label": "Audit Logging",
      "help": "Emit structured audit summaries for guardrail decisions.",
      "advanced": true
    },
    "maxPendingRequests": {
      "label": "Max Pending Access Requests",
      "help": "Maximum number of pending PII access requests per session (default: 50).",
      "advanced": true
    }
  }
}
